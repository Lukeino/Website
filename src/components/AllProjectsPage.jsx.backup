/**
 * AllProjectsPage Component
 * Author: Luca Iantosco
 * Description: Detailed projects archive page with thumbnails in tables like homepage
 * Date: June 2, 2025
 */

import React, { useEffect } from 'react';
import { useLanguage } from '../contexts/LanguageContext';
import { useLocation } from 'react-router-dom';
import { useScrollAnimation, useStaggeredAnimation } from '../hooks/useScrollAnimation';
import Header from './Header';
import '../styles/App.css';

// Import project images - main project images
import prototipiGif from '../assets/Prototipi.gif';
import sklearnPng from '../assets/Sklearn.png';
import careerConnectPng from '../assets/CareerConnect.png';
import hollowDungeonsPng from '../assets/TheHollowDungeons.jpg';
import healthboardPng from '../assets/Healthboard.png';
import oldPortfolioImage from '../assets/OldPortfolio.png';

// Project thumbnail images configuration - single thumbnail per project like homepage
const projectThumbnails = {
  'Ghost Tower': prototipiGif,
  'Medievalia': prototipiGif,
  'StatsConverter': careerConnectPng,
  'Predizione Prezzo Laptop': sklearnPng,
  'Back to Earth - Prologue': hollowDungeonsPng,
  'VortexCorp Lost Tapes': hollowDungeonsPng,
  'Healthboard': healthboardPng,
  'Old Portfolio': oldPortfolioImage
};

function AllProjectsPage() {
  const { t } = useLanguage();
  const location = useLocation();
  const sectionRef = useScrollAnimation();
  const softwareTableRef = useStaggeredAnimation(150);
  const webdevTableRef = useStaggeredAnimation(150);
  const gameTableRef = useStaggeredAnimation(150);
  const mlTableRef = useStaggeredAnimation(150);

  // Assicurati sempre che la pagina parta dall'inizio quando viene caricata
  useEffect(() => {
    // Solo se non c'Ã¨ hash nell'URL, forza lo scroll all'inizio
    if (!location.hash) {
      // Forza immediatamente lo scroll all'inizio con scrollBehavior instant
      window.scrollTo({
        top: 0,
        left: 0,
        behavior: 'instant'
      });
      
      // Backup con timeout multipli per essere super sicuri
      const timeouts = [
        setTimeout(() => window.scrollTo(0, 0), 10),
        setTimeout(() => window.scrollTo(0, 0), 50),
        setTimeout(() => window.scrollTo(0, 0), 100),
        setTimeout(() => window.scrollTo(0, 0), 200)
      ];
      
      return () => timeouts.forEach(clearTimeout);
    }
    
    // Se c'Ã¨ un hash, aggiungi solo un listener per il load come backup
    const handleLoad = () => {
      if (!location.hash) {
        window.scrollTo(0, 0);
      }
    };
    window.addEventListener('load', handleLoad);
    
    return () => {
      window.removeEventListener('load', handleLoad);
    };
  }, [location.hash]);

  // Forza scroll all'inizio quando il pathname include 'all-projects' MA SOLO se non c'Ã¨ hash
  useEffect(() => {
    if (location.pathname === '/all-projects' && !location.hash) {
      // Scroll immediato e aggressivo solo se non c'Ã¨ hash
      window.scrollTo({
        top: 0,
        left: 0,
        behavior: 'instant'
      });
      
      // Backup multipli
      setTimeout(() => window.scrollTo(0, 0), 0);
      setTimeout(() => window.scrollTo(0, 0), 10);
      setTimeout(() => window.scrollTo(0, 0), 50);
    }
  }, [location.pathname, location.hash]);

  // Scroll to the correct section when page loads with hash
  useEffect(() => {
    if (location.hash) {
      const element = document.querySelector(location.hash);
      if (element) {
        // Aumentiamo il timeout per assicurarci che la pagina sia completamente caricata
        setTimeout(() => {
          element.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }, 300);
      }
    } else {
      // Se non c'Ã¨ hash, forza lo scroll all'inizio (solo come backup)
      setTimeout(() => {
        window.scrollTo(0, 0);
      }, 10);
    }
  }, [location.hash]);

  // Project data for tables with thumbnails
  const tableProjects = {
    software: [
      {
        id: 'sw1',
        title: t('statsConverterTitle'),
        description: t('statsConverterDesc'),
        githubLink: 'https://github.com/Lukeino/StatsConverter-0.1.0a',
        downloadLink: 'https://mega.nz/file/HK5lkBqL#QNWWsfOOJcmGZ55nSC3U-4en_WDpROoscFrDCaQGJHc',
        thumbnail: projectThumbnails['StatsConverter']
      }
    ],
    webdev: [
      {
        id: 'web1',
        title: t('healthboardTitle'),
        description: t('healthboardDesc'),
        githubLink: 'https://github.com/Lukeino/Healthboard-website',
        thumbnail: projectThumbnails['Healthboard']
      },
      {
        id: 'web2',
        title: t('oldPortfolioTitle'),
        description: t('oldPortfolioDesc'),
        githubLink: 'https://github.com/Lukeino/PortfolioWebsite-Legacy-',
        thumbnail: projectThumbnails['Old Portfolio']
      }
    ],
    prototypes: [
      {
        id: 'proto1',
        title: 'Ghost Tower',
        description: t('ghostTowerDesc'),
        thumbnail: projectThumbnails['Ghost Tower']
      },
      {
        id: 'proto3',
        title: 'Back to Earth - Prologue',
        description: t('backToEarthDesc'),
        thumbnail: projectThumbnails['Back to Earth - Prologue']
      },
      {
        id: 'proto4',
        title: 'VortexCorp Lost Tapes',
        description: t('vortexCorpDesc'),
        downloadLink: 'https://mega.nz/file/DC5FRSQb#K1ghRzG3YO0_tUIjDi6ULX7LoVhvzyBik5lq_u5aekc',
        thumbnail: projectThumbnails['VortexCorp Lost Tapes']
      }
    ],
    sklearn: [
      {
        id: 'ml1',
        title: 'Predizione Prezzo Laptop',
        description: t('laptopPricePredictionDesc'),
        githubLink: 'https://github.com/Lukeino/ML-Sklearn-Projects/tree/main/LaptopPricePrediction',
        thumbnail: projectThumbnails['Predizione Prezzo Laptop']
      },
      {
        id: 'ml2',
        title: 'Medievalia',
        description: t('medievaliaDesc'),
        githubLink: 'https://github.com/Lukeino/Medievalia',
        thumbnail: projectThumbnails['Medievalia']
      }
    ]
  };

  const renderTableProjectRow = (project) => (
    <tr key={project.id} className="luca-stagger-item">
      <td data-label={t('thumbnail')} className="project-thumbnail">
        {project.thumbnail ? (
          <img 
            src={project.thumbnail} 
            alt={project.title} 
            className="project-table-img"
          />
        ) : (
          <div className="placeholder-thumbnail">
            <span>ðŸ“·</span>
          </div>
        )}
      </td>
      <td data-label={t('projectTitle')} className="project-title">{project.title}</td>
      <td data-label={t('projectDescription')} className="project-description">{project.description}</td>
      <td data-label="" className="project-actions">
        <div className="action-buttons">
          {project.githubLink ? (
            <a href={project.githubLink} className="btn-icon github-btn" target="_blank" rel="noopener noreferrer" title="GitHub">
              <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"/>
              </svg>
            </a>
          ) : (
            <span className="btn-icon github-btn disabled" title="Non disponibile">
              <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"/>
              </svg>
            </span>
          )}
          {project.downloadLink ? (
            <a href={project.downloadLink} className="btn-icon download-btn" target="_blank" rel="noopener noreferrer" title="Download">
              <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
                <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>
              </svg>
            </a>
          ) : (
            <span className="btn-icon download-btn disabled" title="Non disponibile">
              <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
                <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>
              </svg>
            </span>
          )}
        </div>
      </td>
    </tr>
  );

  return (
    <>
      <Header />
      <section id="all-projects-page" className="projects luca-scroll-animate" style={{ paddingTop: '100px' }} ref={sectionRef}>
        <div className="container">
          <h2 className="pixel-text">{t('allProjectsTitle')}</h2>

          {/* Software Development Table */}
          <div className="project-category" id="software-development">
            <h3 className="category-title centered-title">{t('softwareDevProjects')}</h3>
            <div className="table-responsive" ref={softwareTableRef}>
              <table className="project-table">
                <thead>
                  <tr>
                    <th className="centered-header">{t('thumbnail')}</th>
                    <th className="centered-header">{t('projectTitle')}</th>
                    <th className="centered-header">{t('projectDescription')}</th>
                    <th></th>
                  </tr>
                </thead>
                <tbody>
                  {tableProjects.software.map(renderTableProjectRow)}
                </tbody>
              </table>
            </div>
          </div>

          {/* Web Development Table */}
          <div className="project-category" id="web-development">
            <h3 className="category-title centered-title">{t('webDevProjects')}</h3>
            <div className="table-responsive" ref={webdevTableRef}>
              <table className="project-table">
                <thead>
                  <tr>
                    <th className="centered-header">{t('thumbnail')}</th>
                    <th className="centered-header">{t('projectTitle')}</th>
                    <th className="centered-header">{t('projectDescription')}</th>
                    <th></th>
                  </tr>
                </thead>
                <tbody>
                  {tableProjects.webdev.map(renderTableProjectRow)}
                </tbody>
              </table>
            </div>
          </div>

          {/* Game Prototypes Table */}
          <div className="project-category" id="game-prototypes">
            <h3 className="category-title centered-title">{t('gamePrototypes', 'Prototipi di Gioco')}</h3>
            <div className="table-responsive" ref={gameTableRef}>
              <table className="project-table">
                <thead>
                  <tr>
                    <th className="centered-header">{t('thumbnail')}</th>
                    <th className="centered-header">{t('projectTitle')}</th>
                    <th className="centered-header">{t('projectDescription')}</th>
                    <th></th>
                  </tr>
                </thead>
                <tbody>
                  {tableProjects.prototypes.map(renderTableProjectRow)}
                </tbody>
              </table>
            </div>
          </div>

          {/* ML Projects Table */}
          <div className="project-category" id="ml-projects">
            <h3 className="category-title centered-title">{t('mlProjects', 'Progetti Machine Learning')}</h3>
            <div className="table-responsive" ref={mlTableRef}>
              <table className="project-table">
                <thead>
                  <tr>
                    <th className="centered-header">{t('thumbnail')}</th>
                    <th className="centered-header">{t('projectTitle')}</th>
                    <th className="centered-header">{t('projectDescription')}</th>
                    <th></th>
                  </tr>
                </thead>
                <tbody>
                  {tableProjects.sklearn.map(renderTableProjectRow)}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </section>
    </>
  );
}

export default AllProjectsPage;
      window.scrollTo({
        top: 0,
        left: 0,
        behavior: 'instant'
      });
      
      // Backup multipli
      setTimeout(() => window.scrollTo(0, 0), 0);
      setTimeout(() => window.scrollTo(0, 0), 10);
      setTimeout(() => window.scrollTo(0, 0), 50);
    }
  }, [location.pathname, location.hash]);

  // Scroll to the correct section when page loads with hash
  useEffect(() => {
    if (location.hash) {
      const element = document.querySelector(location.hash);
      if (element) {
        // Aumentiamo il timeout per assicurarci che la pagina sia completamente caricata
        setTimeout(() => {
          element.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }, 300);
      }
    } else {
      // Se non c'Ã¨ hash, forza lo scroll all'inizio (solo come backup)
      setTimeout(() => {
        window.scrollTo(0, 0);
      }, 10);
    }
  }, [location.hash]);

  // Project data for tables
  const tableProjects = {
    software: [
      {
        id: 'sw1',
        title: t('statsConverterTitle'),
        description: t('statsConverterDesc'),
        githubLink: 'https://github.com/Lukeino/StatsConverter-0.1.0a',
        playLink: null,
        downloadLink: 'https://mega.nz/file/HK5lkBqL#QNWWsfOOJcmGZ55nSC3U-4en_WDpROoscFrDCaQGJHc',
        thumbnail: projectThumbnails['StatsConverter']
      }
    ],
    webdev: [
      {
        id: 'web1',
        title: t('healthboardTitle'),
        description: t('healthboardDesc'),
        githubLink: 'https://github.com/Lukeino/Healthboard-website',
        playLink: null,
        downloadLink: null,
        thumbnail: projectThumbnails['Healthboard']
      },
      {
        id: 'web2',
        title: t('oldPortfolioTitle'),
        description: t('oldPortfolioDesc'),
        githubLink: 'https://github.com/Lukeino/PortfolioWebsite-Legacy-',
        playLink: null,
        downloadLink: null,
        thumbnail: projectThumbnails['Old Portfolio']
      }
    ],
    prototypes: [
      {
        id: 'proto1',
        title: 'Ghost Tower',
        description: t('ghostTowerDesc'),
        githubLink: null,
        playLink: null,
        downloadLink: null,
        thumbnail: projectThumbnails['Ghost Tower']
      },
      {
        id: 'proto3',
        title: 'Back to Earth - Prologue',
        description: t('backToEarthDesc'),
        githubLink: null,
        playLink: null,
        downloadLink: null,
        thumbnail: projectThumbnails['Back to Earth - Prologue']
      },
      {
        id: 'proto4',
        title: 'VortexCorp Lost Tapes',
        description: t('vortexCorpDesc'),
        githubLink: null,
        playLink: null,
        downloadLink: 'https://mega.nz/file/DC5FRSQb#K1ghRzG3YO0_tUIjDi6ULX7LoVhvzyBik5lq_u5aekc',
        thumbnail: projectThumbnails['VortexCorp Lost Tapes']
      }
    ],
    sklearn: [
      {
        id: 'ml1',
        title: 'Predizione Prezzo Laptop',
        description: t('laptopPricePredictionDesc'),
        githubLink: 'https://github.com/Lukeino/ML-Sklearn-Projects/tree/main/LaptopPricePrediction',
        playLink: null,
        downloadLink: null,
        thumbnail: projectThumbnails['Predizione Prezzo Laptop']
      },
      {
        id: 'ml2',
        title: 'Medievalia',
        description: t('medievaliaDesc'),
        githubLink: 'https://github.com/Lukeino/Medievalia',
        playLink: null,
        downloadLink: null,
        thumbnail: projectThumbnails['Medievalia']
      }
    ]
  };

  const renderTableProjectRow = (project) => (
    <tr key={project.id} className="luca-stagger-item">
      <td data-label={t('thumbnail')} className="project-thumbnail">
        {project.thumbnail ? (
          <img 
            src={project.thumbnail} 
            alt={project.title} 
            className="project-table-img"
          />
        ) : (
          <div className="placeholder-thumbnail">
            <span>ðŸ“·</span>
          </div>
        )}
      </td>
      <td data-label={t('projectTitle')} className="project-title">{project.title}</td>
      <td data-label={t('projectDescription')} className="project-description">{project.description}</td>
      <td data-label="" className="project-actions">
        <div className="action-buttons">
          {project.githubLink ? (
            <a href={project.githubLink} className="btn-icon github-btn" target="_blank" rel="noopener noreferrer" title="GitHub">
              <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"/>
              </svg>
            </a>
          ) : (
            <span className="btn-icon github-btn disabled" title="Non disponibile">
              <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"/>
              </svg>
            </span>
          )}
          {project.downloadLink ? (
            <a href={project.downloadLink} className="btn-icon download-btn" target="_blank" rel="noopener noreferrer" title="Download">
              <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
                <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>
              </svg>
            </a>
          ) : (
  const renderTableProjectRow = (project) => (
    <tr key={project.id} className="luca-stagger-item">
      <td data-label={t('thumbnail')} className="project-thumbnail">
        {project.thumbnail ? (
          <img 
            src={project.thumbnail} 
            alt={project.title} 
            className="project-table-img"
          />
        ) : (
          <div className="placeholder-thumbnail">
            <span>ðŸ“·</span>
          </div>
        )}
      </td>
      <td data-label={t('projectTitle')} className="project-title">{project.title}</td>
      <td data-label={t('projectDescription')} className="project-description">{project.description}</td>
      <td data-label="" className="project-actions">
        <div className="action-buttons">
          {project.githubLink ? (
            <a href={project.githubLink} className="btn-icon github-btn" target="_blank" rel="noopener noreferrer" title="GitHub">
              <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"/>
              </svg>
            </a>
          ) : (
            <span className="btn-icon github-btn disabled" title="Non disponibile">
              <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"/>
              </svg>
            </span>
          )}
          {project.downloadLink ? (
            <a href={project.downloadLink} className="btn-icon download-btn" target="_blank" rel="noopener noreferrer" title="Download">
              <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
                <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>
              </svg>
            </a>
          ) : (
            <span className="btn-icon download-btn disabled" title="Non disponibile">
              <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
                <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>
              </svg>
            </span>
          )}
        </div>
      </td>
    </tr>
  );
  return (
    <>
      <Header />
      <section id="all-projects-page" className="projects luca-scroll-animate" style={{ paddingTop: '100px' }} ref={sectionRef}>
        <div className="container">
          <h2 className="pixel-text">{t('allProjectsTitle')}</h2>

          {/* Software Development Table */}
          <div className="project-category" id="software-development">
            <h3 className="category-title centered-title">{t('softwareDevProjects')}</h3>
            <div className="table-responsive" ref={softwareTableRef}>
              <table className="project-table">
                <thead>
                  <tr>
                    <th className="centered-header">{t('projectTitle')}</th>
                    <th className="centered-header">{t('projectDescription')}</th>
                    <th></th>
                  </tr>
                </thead>
                <tbody>
                  {tableProjects.software.map(renderTableProjectRow)}
                </tbody>
              </table>
            </div>
          </div>

          {/* Web Development Table */}
          <div className="project-category" id="web-development">
            <h3 className="category-title centered-title">{t('webDevProjects')}</h3>
            <div className="table-responsive" ref={webdevTableRef}>
              <table className="project-table">
                <thead>
                  <tr>
                    <th className="centered-header">{t('projectTitle')}</th>
                    <th className="centered-header">{t('projectDescription')}</th>
                    <th></th>
                  </tr>
                </thead>
                <tbody>
                  {tableProjects.webdev.map(renderTableProjectRow)}
                </tbody>
              </table>
            </div>
          </div>

          {/* Game Prototypes Table */}
          <div className="project-category" id="game-prototypes">
            <h3 className="category-title centered-title">{t('gamePrototypes', 'Prototipi di Gioco')}</h3>
            <div className="table-responsive" ref={gameTableRef}>
              <table className="project-table">
                <thead>
                  <tr>
                    <th className="centered-header">{t('projectTitle')}</th>
                    <th className="centered-header">{t('projectDescription')}</th>
                    <th></th>
                  </tr>
                </thead>
                <tbody>
                  {tableProjects.prototypes.map(renderTableProjectRow)}
                </tbody>
              </table>
            </div>
          </div>

          {/* Machine Learning Projects Table */}
          <div className="project-category" id="ml-projects">
            <h3 className="category-title centered-title">{t('mlProjects', 'Progetti Machine Learning')}</h3>
            <div className="table-responsive" ref={mlTableRef}>
              <table className="project-table">
                <thead>
                  <tr>
                    <th className="centered-header">{t('projectTitle')}</th>
                    <th className="centered-header">{t('projectDescription')}</th>
                    <th></th>
                  </tr>
                </thead>
                <tbody>
                  {tableProjects.sklearn.map(renderTableProjectRow)}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </section>

      {/* Image Gallery Overlay */}
      {galleryOpen && currentProject && (
        <div className="gallery-overlay" onClick={closeGallery}>
          <div className="gallery-container" onClick={(e) => e.stopPropagation()}>
            <button className="gallery-close" onClick={closeGallery}>
              <svg width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                <path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z"/>
              </svg>
            </button>
            
            <div className="gallery-header">
              <div className="gallery-title-section">
                <p className="gallery-subtitle">{t('imageGallery')}</p>
                <h3 className="gallery-title">{currentProject.title}</h3>
              </div>
            </div>

            <div className="gallery-content">
              {currentProject.images && currentProject.images.length > 1 && (
                <button className="gallery-nav gallery-prev" onClick={prevImage}>
                  <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                    <path fillRule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"/>
                  </svg>
                </button>
              )}

              <div className="gallery-image-container">
                <img 
                  src={currentProject.images?.[currentImageIndex]} 
                  alt={`${currentProject.title} - Screenshot ${currentImageIndex + 1}`}
                  className="gallery-image"
                />
              </div>

              {currentProject.images && currentProject.images.length > 1 && (
                <button className="gallery-nav gallery-next" onClick={nextImage}>
                  <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                    <path fillRule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
                  </svg>
                </button>
              )}
            </div>

            {currentProject.images && currentProject.images.length > 1 && (
              <div className="gallery-dots">
                {currentProject.images.map((_, index) => (
                  <button
                    key={index}
                    className={`gallery-dot ${index === currentImageIndex ? 'active' : ''}`}
                    onClick={() => setCurrentImageIndex(index)}
                  />
                ))}
              </div>
            )}
          </div>
        </div>
      )}
    </>
  );
}

export default AllProjectsPage;
